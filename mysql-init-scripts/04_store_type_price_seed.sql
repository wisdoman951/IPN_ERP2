-- -----------------------------------------------------
-- Store-type purchase cost data based on provided price lists
-- -----------------------------------------------------
START TRANSACTION;

WITH direct_raw AS (
    SELECT 'PSA10' AS master_code, 1100.00 AS cost_price UNION ALL
    SELECT 'PSA20', 1100.00 UNION ALL
    SELECT 'PSB10', 520.00 UNION ALL
    SELECT 'PSO01', 350.00 UNION ALL
    SELECT 'PSS01', 350.00 UNION ALL
    SELECT 'PCP01', 2350.00 UNION ALL
    SELECT 'PCP02', 4700.00 UNION ALL
    SELECT 'PCP03', 2660.00 UNION ALL
    SELECT 'PCP04', 620.00 UNION ALL
    SELECT 'PCP05', 333.00 UNION ALL
    SELECT 'PCP06', 267.00 UNION ALL
    SELECT 'SMA01', 3000.00 UNION ALL
    SELECT 'SMA02', 1600.00 UNION ALL
    SELECT 'SMA03', 1000.00 UNION ALL
    SELECT 'SMA04', 300.00 UNION ALL
    SELECT 'SMA05', 200.00 UNION ALL
    SELECT 'SMA06', 300.00 UNION ALL
    SELECT 'SMA07', 90.00 UNION ALL
    SELECT 'SMA08', 75.00 UNION ALL
    SELECT 'SMA09', 85.00 UNION ALL
    SELECT 'SMA10', 550.00 UNION ALL
    SELECT 'SMA11', 420.00 UNION ALL
    SELECT 'SMA12', 200.00 UNION ALL
    SELECT 'SMW01', 420.00 UNION ALL
    SELECT 'SMW02', 420.00 UNION ALL
    SELECT 'SMW03', 420.00 UNION ALL
    SELECT 'SMW04', 420.00 UNION ALL
    SELECT 'SMW05', 350.00 UNION ALL
    SELECT 'SMW06', 200.00 UNION ALL
    SELECT 'SHA01', 1500.00 UNION ALL
    SELECT 'SHA02', 1400.00 UNION ALL
    SELECT 'SHA03', 1300.00 UNION ALL
    SELECT 'SHA04', 1200.00 UNION ALL
    SELECT 'SHA05', 160.00 UNION ALL
    SELECT 'SHA06', 200.00 UNION ALL
    SELECT 'SHA07', 450.00 UNION ALL
    SELECT 'SHA08', 300.00 UNION ALL
    SELECT 'SHA09', 150.00 UNION ALL
    SELECT 'SHA10', 90.00 UNION ALL
    SELECT 'SHA11', 75.00 UNION ALL
    SELECT 'SHA12', 100.00 UNION ALL
    SELECT 'SHA14', 50.00 UNION ALL
    SELECT 'SHA15', 70.00 UNION ALL
    SELECT 'SHA16', 399.00 UNION ALL
    SELECT 'SHA17', 350.00 UNION ALL
    SELECT 'SHW01', 310.00 UNION ALL
    SELECT 'SHW02', 220.00 UNION ALL
    SELECT 'SHW03', 220.00 UNION ALL
    SELECT 'SHW04', 220.00 UNION ALL
    SELECT 'SHW05', 515.00 UNION ALL
    SELECT 'SHW06', 420.00 UNION ALL
    SELECT 'SHW07', 420.00 UNION ALL
    SELECT 'SHW08', 350.00 UNION ALL
    SELECT 'SPO01', 100.00 UNION ALL
    SELECT 'SPO02', 35.00 UNION ALL
    SELECT 'SPO03', 200.00 UNION ALL
    SELECT 'SPO04', 420.00 UNION ALL
    SELECT 'SPO05', 330.00 UNION ALL
    SELECT 'SPO06', 300.00 UNION ALL
    SELECT 'SPO07', 400.00 UNION ALL
    SELECT 'SPO08', 400.00 UNION ALL
    SELECT 'SSO01', 750.00 UNION ALL
    SELECT 'SSO02', 90.00 UNION ALL
    SELECT 'SSO03', 130.00 UNION ALL
    SELECT 'SSO04', 400.00 UNION ALL
    SELECT 'SSO05', 550.00 UNION ALL
    SELECT 'SSO06', 900.00 UNION ALL
    SELECT 'SSO07', 435.00 UNION ALL
    SELECT 'SSO08', 300.00 UNION ALL
    SELECT 'SCP01', 0.00 UNION ALL
    SELECT 'SCP01', 4600.00 UNION ALL
    SELECT 'SCP01', 1000.00 UNION ALL
    SELECT 'SCP02', 0.00 UNION ALL
    SELECT 'SCP02', 4600.00 UNION ALL
    SELECT 'SCP02', 1000.00 UNION ALL
    SELECT 'SCP03', 0.00 UNION ALL
    SELECT 'SCP03', 4600.00 UNION ALL
    SELECT 'SCP03', 1000.00 UNION ALL
    SELECT 'SCP04', 0.00 UNION ALL
    SELECT 'SCP04', 4600.00 UNION ALL
    SELECT 'SCP04', 1000.00
), direct_prices AS (
    SELECT master_code, MAX(cost_price) AS cost_price
    FROM direct_raw
    GROUP BY master_code
)
INSERT INTO store_type_price (master_product_id, store_type, cost_price)
SELECT mp.master_product_id, 'DIRECT', dp.cost_price
FROM direct_prices dp
JOIN master_product mp ON mp.master_product_code = dp.master_code
ON DUPLICATE KEY UPDATE cost_price = VALUES(cost_price);

WITH franchise_raw AS (
    SELECT 'PSA10' AS master_code, 1300.00 AS cost_price UNION ALL
    SELECT 'PSA20', 1300.00 UNION ALL
    SELECT 'PSB10', 660.00 UNION ALL
    SELECT 'PSO01', 500.00 UNION ALL
    SELECT 'PSO01', 470.00 UNION ALL
    SELECT 'PSO01', 440.00 UNION ALL
    SELECT 'PSS01', 450.00 UNION ALL
    SELECT 'PCP01', 2450.00 UNION ALL
    SELECT 'PCP02', 4900.00 UNION ALL
    SELECT 'PCP03', 2830.00 UNION ALL
    SELECT 'PCP04', 800.00 UNION ALL
    SELECT 'PCP04', 720.00 UNION ALL
    SELECT 'SMA01', 3200.00 UNION ALL
    SELECT 'SMA02', 2000.00 UNION ALL
    SELECT 'SMA03', 1200.00 UNION ALL
    SELECT 'SMA04', 400.00 UNION ALL
    SELECT 'SMA05', 300.00 UNION ALL
    SELECT 'SMA06', 400.00 UNION ALL
    SELECT 'SMA07', 120.00 UNION ALL
    SELECT 'SMA08', 100.00 UNION ALL
    SELECT 'SMA09', 120.00 UNION ALL
    SELECT 'SMA10', 620.00 UNION ALL
    SELECT 'SMA11', 450.00 UNION ALL
    SELECT 'SMA12', 250.00 UNION ALL
    SELECT 'SMW01', 430.00 UNION ALL
    SELECT 'SMW02', 430.00 UNION ALL
    SELECT 'SMW03', 430.00 UNION ALL
    SELECT 'SMW04', 430.00 UNION ALL
    SELECT 'SMW05', 380.00 UNION ALL
    SELECT 'SMW06', 250.00 UNION ALL
    SELECT 'SHA01', 1600.00 UNION ALL
    SELECT 'SHA02', 1500.00 UNION ALL
    SELECT 'SHA03', 1400.00 UNION ALL
    SELECT 'SHA04', 1300.00 UNION ALL
    SELECT 'SHA05', 300.00 UNION ALL
    SELECT 'SHA06', 300.00 UNION ALL
    SELECT 'SHA07', 500.00 UNION ALL
    SELECT 'SHA08', 400.00 UNION ALL
    SELECT 'SHA09', 300.00 UNION ALL
    SELECT 'SHA10', 120.00 UNION ALL
    SELECT 'SHA11', 100.00 UNION ALL
    SELECT 'SHA12', 100.00 UNION ALL
    SELECT 'SHA14', 60.00 UNION ALL
    SELECT 'SHA15', 90.00 UNION ALL
    SELECT 'SHA16', 399.00 UNION ALL
    SELECT 'SHA17', 350.00 UNION ALL
    SELECT 'SHW01', 320.00 UNION ALL
    SELECT 'SHW02', 230.00 UNION ALL
    SELECT 'SHW03', 230.00 UNION ALL
    SELECT 'SHW04', 230.00 UNION ALL
    SELECT 'SHW05', 515.00 UNION ALL
    SELECT 'SHW06', 430.00 UNION ALL
    SELECT 'SHW07', 430.00 UNION ALL
    SELECT 'SHW08', 380.00 UNION ALL
    SELECT 'SPO01', 120.00 UNION ALL
    SELECT 'SPO02', 40.00 UNION ALL
    SELECT 'SPO03', 220.00 UNION ALL
    SELECT 'SPO04', 500.00 UNION ALL
    SELECT 'SPO05', 380.00 UNION ALL
    SELECT 'SPO06', 350.00 UNION ALL
    SELECT 'SPO07', 420.00 UNION ALL
    SELECT 'SPO08', 480.00 UNION ALL
    SELECT 'SSO01', 1000.00 UNION ALL
    SELECT 'SSO02', 100.00 UNION ALL
    SELECT 'SSO03', 150.00 UNION ALL
    SELECT 'SSO04', 480.00 UNION ALL
    SELECT 'SSO05', 550.00 UNION ALL
    SELECT 'SSO06', 900.00 UNION ALL
    SELECT 'SSO07', 435.00 UNION ALL
    SELECT 'SSO08', 300.00 UNION ALL
    SELECT 'SCP01', 0.00 UNION ALL
    SELECT 'SCP01', 4600.00 UNION ALL
    SELECT 'SCP01', 1000.00 UNION ALL
    SELECT 'SCP02', 0.00 UNION ALL
    SELECT 'SCP02', 4600.00 UNION ALL
    SELECT 'SCP02', 1000.00 UNION ALL
    SELECT 'SCP03', 0.00 UNION ALL
    SELECT 'SCP03', 4600.00 UNION ALL
    SELECT 'SCP03', 1000.00 UNION ALL
    SELECT 'SCP04', 0.00 UNION ALL
    SELECT 'SCP04', 4600.00 UNION ALL
    SELECT 'SCP04', 1000.00
), franchise_prices AS (
    SELECT master_code, MAX(cost_price) AS cost_price
    FROM franchise_raw
    GROUP BY master_code
)
INSERT INTO store_type_price (master_product_id, store_type, cost_price)
SELECT mp.master_product_id, 'FRANCHISE', fp.cost_price
FROM franchise_prices fp
JOIN master_product mp ON mp.master_product_code = fp.master_code
ON DUPLICATE KEY UPDATE cost_price = VALUES(cost_price);

COMMIT;
